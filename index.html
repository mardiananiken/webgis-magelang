<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <!-- Judul pada tab browser -->
    <title>LeafletJS</title>

    <!-- Leaflet CSS Library -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css">

    <!-- Style untuk tampilan peta fullscreen -->
    <style>
        html,
        body,
        #map {
            height: 100%;
            width: 100%;
            margin: 0px;
        }
    </style>
</head>

<body>
    <!-- Leaflet JavaScript Library -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

    <!-- HTML Block untuk menampilkan peta -->
    <div id="map"></div>
    <script>
        /* Initial Map */
        var map = L.map('map').setView([-7.4770702, 110.2183628
        ], 10); //lat, long, zoom

        /* Tile Basemap */
        var basemap = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            //attribution akan muncul di pojok kanan bawah
            attribution: '<a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> | <a href="https://www.unsorry.net" target="_blank">unsorry@2022</a>'
        });
        basemap.addTo(map); //Memanggil basemap untuk ditampilkan ketika halaman dipanggil

        /* GeoJSON Polygon */
        var batasdesamangelang = L.geoJson(null, {
            /* Style polygon */
            style: function (feature) { //Fungsi style polygon
                return {
                    fillColor: "white", //Warna tengah polygon
                    fillOpacity: 0.7, //Transparansi tengah polygon
                    color: "black", //Warna garis tepi polygon
                    weight: 1, //Tebal garis tepi polygon
                    opacity: 1, //Transparansi garis tepi polygon
                };
            },
            /* Highlight & Popup */
            onEachFeature: function (feature, layer) {
                layer.on({
                    mouseover: function (e) { //Fungsi ketika mouse berada di atas obyek
                        var layer = e.target; //variabel layer
                        layer.setStyle({ //Highlight style
                            weight: 2, //Tebal garis tepi polygon
                            color: "#00FFFF", //Warna garis tepi polygon
                            opacity: 1, //Transparansi garis tepi polygon
                            fillColor: "#ccffcc", //Warna tengah polygon
                            fillOpacity: 0.5, //Transparansi tengah polygon
                        });
                    },
                    mouseout: function (e) { //Fungsi ketika mouse keluar dari area obyek
                        batasdesamangelang.resetStyle(e.target); //Mengembalikan style polygon ke style awal
                        map.closePopup(); //Menutup popup
                    },
                    click: function (e) { //Fungsi ketika obyek di-klik
                        batasdesamangelang.bindPopup(feature.properties.NAMOBJ); //Popup
                    }
                });
            }
        });
        /* memanggil data geojson polygon */
        $.getJSON("data/ADMINISTRASIDESA_AR_25K.geojson", function (data) {
            batasdesamangelang.addData(data);
            map.addLayer(batasdesamangelang); //batasdesamangelang ditampilkan ketika halaman dipanggil
            map.fitBounds(batasdesamangelang.getBounds());
        });
        /* GeoJSON Polyline */
        var jalanutama = L.geoJson(null, {
            /* Style polyline */
            style: function (feature) { //Fungsi style polyline
                return {
                    color: "red", //Warna garis
                    weight: 2, //Tebal garis
                    opacity: 1, //Transparansi garis
                };
            },
            /* Highlight & Popup */
            onEachFeature: function (feature, layer) {
                layer.on({
                    mouseover: function (e) { //Fungsi ketika mouse berada di atas obyek
                        var layer = e.target; //variabel layer
                        layer.setStyle({ //Highlight style
                            weight: 2,  //Tebal garis
                            color: "#00FFFF", //Warna garis
                            opacity: 1, //Transparansi garis
                        });
                    },
                    mouseout: function (e) { //Fungsi ketika mouse keluar dari area obyek
                        jalanutama.resetStyle(e.target); //Mengembalikan style garis ke style awal
                        map.closePopup(); //Menutup popup
                    },
                    click: function (e) { //Fungsi ketika obyek di-klik
                        var content = "Jenis: " + feature.properties.REMARK;
                        jalanutama.bindPopup(content); //Popup
                    }
                });
            }
        });
        /* memanggil data geojson polyline */
        $.getJSON("data/jalan.geojson", function (data) {
            jalanutama.addData(data);
            map.addLayer(jalanutama); //jalanutama ditampilkan ketika halaman dipanggil
        });

        /* GeoJSON Point */
        var pendidikan = L.geoJson(null, {
            /* Popup */
            onEachFeature: function (feature, layer) {
                if (feature.properties) {
                    /* Variabel untuk memanggil atribut dari data geojson */
                    layer.on({
                        click: function (e) { //Fungsi ketika icon simbol di-klik
                            pendidikan.bindPopup(feature.properties.REMARK);
                        }
                    });
                }
            }
        });
        /* memanggil data geojson point */
        $.getJSON("data/pendidikan.geojson", function (data) {
            pendidikan.addData(data);
            map.addLayer(pendidikan); //titikkabkota ditampilkan ketika halaman dipanggil
        });

        var baseMaps = { //list basemap
            'Open Street Map': basemap,
        };
        var Layers = {  //list layer
            'Pendidikan': pendidikan,
            'Jalan Utama': jalanutama,
            'Batas Desa Magelang': batasdesamangelang,
        };
        var layerControl = L.control.layers(baseMaps, Layers, { collapsed: false });
        layerControl.addTo(map);
    </script>
</body>

</html>